CREATE TABLE employees(id INTEGER PRIMARY KEY, name TEXT NOT NULL, age INTEGER CHECK(age > 0), department_id INTEGER);
CREATE TABLE departments(id INTEGER PRIMARY KEY, name TEXT NOT NULL UNIQUE);
CREATE TABLE projects(id INTEGER PRIMARY KEY, name TEXT NOT NULL, start_date DATE, end_date DATE);
CREATE TABLE assignments(employee_id INTEGER, project_id INTEGER, hours_worked INTEGER CHECK(hours_worked >= 0), 
                         PRIMARY KEY(employee_id, project_id), 
                         FOREIGN KEY(employee_id) REFERENCES employees(id), 
                         FOREIGN KEY(project_id) REFERENCES projects(id));
CREATE INDEX idx_department ON employees(department_id);
CREATE VIEW employee_summary AS 
SELECT e.name, d.name AS department, 
       SUM( CASE WHEN a.hours_worked IS NOT NULL THEN a.hours_worked ELSE 0 END ) AS total_hours
FROM employees e 
LEFT JOIN departments d ON e.department_id = d.id 
LEFT JOIN assignments a ON e.id = a.employee_id 
GROUP BY e.id, d.name;
INSERT INTO departments(name) VALUES ('HR'), ('Engineering'), ('Marketing');
INSERT INTO employees(name, age, department_id) VALUES ('Alice', 30, 1), ('Bob', 25, 2), ('Charlie', 35, 2);
INSERT INTO projects(name, start_date, end_date) VALUES ('Project Alpha', '2023-01-01', '2023-06-30'), 
                                                         ('Project Beta', '2023-07-01', '2023-12-31');
INSERT INTO assignments(employee_id, project_id, hours_worked) VALUES (1, 1, 120), (2, 1, 150), (3, 2, 75);
SELECT * FROM employee_summary WHERE total_hours > 100;
SELECT name FROM employees WHERE age BETWEEN 20 AND 40 ORDER BY age;
UPDATE employees SET age = age + 1 WHERE department_id = 2;
DELETE FROM assignments WHERE hours_worked < 80;