CREATE TABLE users (id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, username VARCHAR(50) UNIQUE NOT NULL, email VARCHAR(100) UNIQUE NOT NULL, created_at DATETIME DEFAULT CURRENT_TIMESTAMP);
CREATE TABLE posts (id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, title VARCHAR(255) NOT NULL, content TEXT NOT NULL, user_id INTEGER NOT NULL REFERENCES users(id), created_at DATETIME DEFAULT CURRENT_TIMESTAMP);
CREATE TABLE comments (id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, post_id INTEGER NOT NULL REFERENCES posts(id), user_id INTEGER NOT NULL REFERENCES users(id), content TEXT NOT NULL, created_at DATETIME DEFAULT CURRENT_TIMESTAMP);
CREATE INDEX idx_user_email ON users(email);
CREATE INDEX idx_post_user ON posts(user_id);

INSERT INTO users (username, email) VALUES ('test_user', 'test@example.com');
INSERT INTO posts (title, content, user_id) VALUES ('First Post', 'This is the content of the first post.', 1);
INSERT INTO comments (post_id, user_id, content) VALUES (1, 1, 'This is a comment.');

SELECT users.username, COUNT(posts.id) AS num_posts FROM users LEFT JOIN posts ON users.id = posts.user_id GROUP BY users.id;
SELECT posts.title, comments.content FROM posts LEFT JOIN comments ON posts.id = comments.post_id WHERE posts.created_at >= datetime('now', '-7 days');
SELECT COUNT(*) FROM comments WHERE post_id IN (SELECT id FROM posts WHERE user_id = 1);
SELECT * FROM users WHERE EXISTS (SELECT 1 FROM posts WHERE posts.user_id = users.id AND posts.title LIKE '%Post%');