CREATE TABLE products ( id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL UNIQUE, price REAL CHECK(price >= 0), stock INTEGER DEFAULT 0, created_at DATETIME DEFAULT CURRENT_TIMESTAMP ); 
CREATE TABLE orders ( order_id INTEGER PRIMARY KEY AUTOINCREMENT, product_id INTEGER REFERENCES products(id), quantity INTEGER CHECK(quantity > 0), order_date DATETIME DEFAULT CURRENT_TIMESTAMP ); 
CREATE INDEX idx_product_name ON products(name); 

INSERT INTO products (name, price, stock) VALUES ('Widget A', 19.99, 100), ('Widget B', 29.99, 50), ('Widget C', 39.99, 0); 
INSERT INTO orders (product_id, quantity) VALUES (1, 2), (2, 1), (3, 5); 

UPDATE products SET stock = stock - 1 WHERE id = 1 AND stock > 0; 
DELETE FROM orders WHERE quantity > (SELECT stock FROM products WHERE id = 3); 

SELECT p.id, p.name, p.price, p.stock, o.quantity FROM products p LEFT JOIN orders o ON p.id = o.product_id WHERE p.stock < 1; 
SELECT * FROM products WHERE name LIKE '%Widget%' ORDER BY price DESC; 
SELECT COUNT(*) AS total_orders, SUM(quantity) AS total_quantity FROM orders GROUP BY product_id HAVING total_quantity > 1;