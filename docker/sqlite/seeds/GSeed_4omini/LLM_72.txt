BEGIN;
CREATE TABLE artist( artist_id INTEGER PRIMARY KEY, name TEXT UNIQUE NOT NULL);
CREATE TABLE album( album_id INTEGER PRIMARY KEY, artist_id INTEGER NOT NULL REFERENCES artist(artist_id), title TEXT UNIQUE NOT NULL, release_year INTEGER);
CREATE TABLE track(track_id INTEGER PRIMARY KEY, album_id INTEGER NOT NULL REFERENCES album(album_id), track_number INTEGER NOT NULL, title TEXT NOT NULL, duration INTEGER, UNIQUE(album_id, track_number));
CREATE TABLE playlist( playlist_id INTEGER PRIMARY KEY, name TEXT UNIQUE NOT NULL);
CREATE TABLE playlist_track( playlist_id INTEGER NOT NULL REFERENCES playlist(playlist_id), track_id INTEGER NOT NULL REFERENCES track(track_id), PRIMARY KEY(playlist_id, track_id));
INSERT INTO artist VALUES(1, 'Artist One'), (2, 'Artist Two'), (3, 'Artist Three');
INSERT INTO album VALUES(1, 1, 'Album A', 2020), (2, 1, 'Album B', 2021), (3, 2, 'Album C', 2022);
INSERT INTO track VALUES(1, 1, 1, 'Track A1', 210), (2, 1, 2, 'Track A2', 240), (3, 2, 1, 'Track B1', 180), (4, 3, 1, 'Track C1', 200);
INSERT INTO playlist VALUES(1, 'My Favorites'), (2, 'Chill Vibes');
INSERT INTO playlist_track VALUES(1, 1), (1, 2), (2, 1), (2, 3);
COMMIT;
SELECT a.name AS artist_name, al.title AS album_title, t.title AS track_title, al.release_year, p.name AS playlist_name 
FROM artist a 
JOIN album al ON a.artist_id = al.artist_id 
JOIN track t ON al.album_id = t.album_id 
LEFT JOIN playlist_track pt ON t.track_id = pt.track_id 
LEFT JOIN playlist p ON pt.playlist_id = p.playlist_id 
ORDER BY a.name, al.release_year DESC, t.track_number;