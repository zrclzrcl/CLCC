CREATE TABLE users(id INTEGER PRIMARY KEY, username TEXT UNIQUE, email TEXT, created_at DATETIME DEFAULT CURRENT_TIMESTAMP);
CREATE TABLE orders(order_id INTEGER PRIMARY KEY, user_id INTEGER, amount REAL, order_date DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY(user_id) REFERENCES users(id));
CREATE INDEX idx_username ON users(username);
CREATE INDEX idx_order_date ON orders(order_date);
INSERT INTO users(username, email) VALUES('testuser1', 'testuser1@example.com');
INSERT INTO users(username, email) VALUES('testuser2', 'testuser2@example.com');
INSERT INTO orders(user_id, amount) VALUES(1, 99.99);
INSERT INTO orders(user_id, amount) VALUES(1, 49.99);
INSERT INTO orders(user_id, amount) VALUES(2, 19.99);
ANALYZE;
UPDATE sqlite_stat1 SET stat='100000 5' WHERE idx='idx_username';
UPDATE sqlite_stat1 SET stat='100000 2' WHERE idx='idx_order_date';
SELECT COUNT(*) FROM orders WHERE user_id = 1;
SELECT AVG(amount) FROM orders WHERE user_id = 1;
SELECT username, COUNT(order_id) AS order_count FROM users LEFT JOIN orders ON users.id = orders.user_id GROUP BY users.id;
SELECT email FROM users WHERE email LIKE '%@example.com';
CREATE TABLE products(product_id INTEGER PRIMARY KEY, product_name TEXT, price REAL, stock INTEGER);
INSERT INTO products(product_name, price, stock) VALUES('Product A', 29.99, 100);
INSERT INTO products(product_name, price, stock) VALUES('Product B', 15.99, 200);
SELECT product_name, price FROM products WHERE stock > 0 ORDER BY price DESC;