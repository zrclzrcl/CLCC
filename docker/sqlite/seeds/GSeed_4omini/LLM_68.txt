CREATE TABLE employees(id INTEGER PRIMARY KEY, name TEXT NOT NULL, salary REAL, department_id INTEGER);
CREATE TABLE departments(id INTEGER PRIMARY KEY, name TEXT NOT NULL);
CREATE INDEX idx_salary ON employees(salary) WHERE salary > 50000;
CREATE INDEX idx_department ON employees(department_id);
INSERT INTO departments(id, name) VALUES (1, 'HR'), (2, 'Engineering'), (3, 'Sales');
INSERT INTO employees(id, name, salary, department_id) VALUES (1, 'Alice', 70000, 2), (2, 'Bob', 45000, 1), (3, 'Charlie', 90000, 2), (4, 'Diana', 30000, 3);
INSERT INTO employees(id, name, salary, department_id) SELECT NULL, 'Eve', 60000 + CAST(RANDOM() % 10000 AS REAL), (RANDOM() % 3) + 1 WHERE NOT EXISTS (SELECT 1 FROM employees WHERE name='Eve');
SELECT name, salary FROM employees WHERE salary > (SELECT AVG(salary) FROM employees) ORDER BY salary DESC;
SELECT d.name, COUNT(e.id) FROM departments d LEFT JOIN employees e ON d.id = e.department_id GROUP BY d.id;
PRAGMA foreign_keys=ON;
SELECT name, department_id FROM employees WHERE department_id IS NULL;
SELECT name FROM employees WHERE salary BETWEEN 40000 AND 80000 AND name LIKE 'A%';
DELETE FROM employees WHERE id = (SELECT id FROM employees ORDER BY salary LIMIT 1);
PRAGMA integrity_check;