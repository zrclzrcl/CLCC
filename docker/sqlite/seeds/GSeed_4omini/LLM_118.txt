PRAGMA foreign_keys = ON;
CREATE TABLE users(id INTEGER PRIMARY KEY, username TEXT UNIQUE, email TEXT NOT NULL);
CREATE TABLE posts(id INTEGER PRIMARY KEY, user_id INTEGER, content TEXT, created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
FOREIGN KEY(user_id) REFERENCES users(id) ON DELETE CASCADE);
CREATE TABLE comments(id INTEGER PRIMARY KEY, post_id INTEGER, user_id INTEGER, comment TEXT, created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
FOREIGN KEY(post_id) REFERENCES posts(id) ON DELETE CASCADE,
FOREIGN KEY(user_id) REFERENCES users(id) ON DELETE SET NULL);
CREATE INDEX idx_username ON users(username);
CREATE INDEX idx_post_user ON posts(user_id);
INSERT INTO users(username, email) VALUES('john_doe', 'john@example.com'), ('jane_doe', 'jane@example.com');
INSERT INTO posts(user_id, content) VALUES(1, 'Hello World!'), (2, 'SQLite is great for testing!');
INSERT INTO comments(post_id, user_id, comment) VALUES(1, 2, 'Nice post!'), (2, 1, 'Thanks for sharing!');
UPDATE users SET email = 'johnny@example.com' WHERE username = 'john_doe';
DELETE FROM comments WHERE id = 1;