CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    username TEXT NOT NULL UNIQUE COLLATE NOCASE,
    email TEXT NOT NULL UNIQUE,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE posts (
    id INTEGER PRIMARY KEY,
    user_id INTEGER,
    content TEXT NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

INSERT INTO users (username, email) VALUES ('TestUser', 'test@example.com');
INSERT INTO users (username, email) VALUES ('SampleUser', 'sample@example.com');
INSERT INTO users (username, email) VALUES ('EdgeCaseUser', 'edge@example.com');

INSERT INTO posts (user_id, content) VALUES (1, 'Hello World');
INSERT INTO posts (user_id, content) VALUES (1, 'SQLite Testing Edge Cases');
INSERT INTO posts (user_id, content) VALUES (2, 'Another Sample Post');

SELECT * FROM users ORDER BY username;
SELECT * FROM posts WHERE user_id = 1;
SELECT username, COUNT(posts.id) AS post_count FROM users LEFT JOIN posts ON users.id = posts.user_id GROUP BY users.id ORDER BY post_count DESC;
SELECT * FROM posts WHERE content LIKE '%Test%';
SELECT * FROM users WHERE created_at >= DATE('now', '-7 days') ORDER BY created_at DESC;

UPDATE users SET email = 'changed@example.com' WHERE username = 'TestUser';
DELETE FROM posts WHERE id = 2;