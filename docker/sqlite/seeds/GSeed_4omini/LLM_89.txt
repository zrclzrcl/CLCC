CREATE TABLE users(id INTEGER PRIMARY KEY, name TEXT, age INTEGER, email TEXT UNIQUE);
CREATE TABLE orders(order_id INTEGER PRIMARY KEY, user_id INTEGER, amount REAL, created_at TEXT, FOREIGN KEY(user_id) REFERENCES users(id));
INSERT INTO users(name, age, email) VALUES('Alice', 30, 'alice@example.com');
INSERT INTO users(name, age, email) VALUES('Bob', 25, 'bob@example.com');
INSERT INTO orders(user_id, amount, created_at) VALUES(1, 150.50, '2023-01-15');
INSERT INTO orders(user_id, amount, created_at) VALUES(2, 200.75, '2023-02-20');
INSERT INTO orders(user_id, amount, created_at) VALUES(1, 99.99, '2023-03-05');

SELECT u.name, COUNT(o.order_id) as order_count
FROM users u
LEFT JOIN orders o ON u.id = o.user_id
GROUP BY u.id
HAVING age > 20
ORDER BY order_count DESC;

UPDATE users SET email = 'alice_new@example.com' WHERE id = 1;

DELETE FROM orders WHERE order_id = 2;

CREATE INDEX idx_user_email ON users(email);
SELECT * FROM orders WHERE created_at BETWEEN '2023-01-01' AND '2023-12-31';