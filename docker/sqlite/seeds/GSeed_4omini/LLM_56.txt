CREATE TABLE users(id INTEGER PRIMARY KEY, username TEXT UNIQUE, email TEXT NOT NULL, created_at DATETIME DEFAULT CURRENT_TIMESTAMP);
CREATE TABLE posts(id INTEGER PRIMARY KEY, user_id INTEGER, content TEXT, created_at DATETIME DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY(user_id) REFERENCES users(id) ON DELETE CASCADE);
CREATE INDEX idx_username ON users(username);
CREATE INDEX idx_userid ON posts(user_id);

INSERT INTO users(username, email) VALUES('user1', 'user1@example.com');
INSERT INTO users(username, email) VALUES('user2', 'user2@example.com');
INSERT INTO users(username, email) VALUES('user3', 'user3@example.com');
INSERT INTO posts(user_id, content) VALUES(1, 'This is the first post by user1.');
INSERT INTO posts(user_id, content) VALUES(1, 'Another post by user1.');
INSERT INTO posts(user_id, content) VALUES(2, 'This is user2\'s post.');

SELECT username, COUNT(posts.id) AS post_count FROM users LEFT JOIN posts ON users.id = posts.user_id GROUP BY users.id ORDER BY post_count DESC;
SELECT email FROM users WHERE username LIKE 'user%';
SELECT content FROM posts WHERE user_id = (SELECT id FROM users WHERE username = 'user1') ORDER BY created_at ASC;
DELETE FROM users WHERE id = 3;
UPDATE posts SET content = 'Updated content for user1\'s first post.' WHERE id = 1;

PRAGMA foreign_keys = ON;
PRAGMA case_sensitive_like = OFF;