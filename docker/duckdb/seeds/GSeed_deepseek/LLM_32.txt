CREATE TABLE t1(a INT, b BIGINT, c BOOLEAN);
CREATE TABLE t2(d TEXT, e DECIMAL(5,2), f TIMESTAMP);
CREATE TABLE t3(g ARRAY<TEXT>, h INT);

INSERT INTO t1 VALUES(1, 9223372036854775807, TRUE);
INSERT INTO t1 VALUES(-2147483648, -9223372036854775808, FALSE);

INSERT INTO t2 VALUES('test', 123.45, '2023-10-10 12:34:56');
INSERT INTO t2 VALUES('', NULL, CURRENT_TIMESTAMP);

INSERT INTO t3 VALUES(ARRAY['a','b','c'], 1);
INSERT INTO t3 VALUES(ARRAY[], -1);

SELECT t1.a, t2.d, COUNT(*) 
FROM t1 
JOIN t2 ON t1.b = CAST(t2.e AS BIGINT)
GROUP BY t1.a, t2.d
HAVING COUNT(*) > 0;

WITH cte AS (
    SELECT a, ROW_NUMBER() OVER (ORDER BY a) as rn 
    FROM t1
)
SELECT * FROM cte WHERE rn % 2 = 0;

CREATE TABLE t4 AS
SELECT d || ' ' || e::TEXT as combined,
       f + INTERVAL '1 day' as next_day
FROM t2
WHERE g IS NOT NULL;

VACUUM;
ANALYZE t3;

SELECT unnest(g) as element, h 
FROM t3 
WHERE array_length(g, 1) > 0;