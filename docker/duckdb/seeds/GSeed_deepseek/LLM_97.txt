CREATE TABLE t1 (id INTEGER PRIMARY KEY, name TEXT);
CREATE TABLE t2 (id INTEGER PRIMARY KEY, value REAL, dt DATE);

INSERT INTO t1 VALUES(1, 'Alice');
INSERT INTO t1 VALUES(2, 'Bob');
INSERT INTO t1 VALUES(3, 'Charlie');

INSERT INTO t2 VALUES(1, 100.5, '2023-01-01');
INSERT INTO t2 VALUES(2, NULL, '2023-01-02');
INSERT INTO t2 VALUES(3, 200.3, '2023-01-03');

SELECT t1.name, t2.value 
FROM t1 
LEFT JOIN t2 ON t1.id = t2.id;

WITH cte AS (
    SELECT id, value, ROW_NUMBER() OVER (ORDER BY dt) as rn
    FROM t2
)
SELECT * FROM cte WHERE rn > 1;

SELECT name, SUM(value) 
FROM t1 
JOIN t2 ON t1.id = t2.id 
WHERE dt >= '2023-01-01' 
GROUP BY name 
HAVING SUM(value) > 50;