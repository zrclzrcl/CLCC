CREATE TABLE t1(
    id INTEGER PRIMARY KEY,
    name VARCHAR(50),
    age INTEGER NOT NULL,
    salary DECIMAL(10, 2),
    hire_date DATE,
    is_active BOOLEAN DEFAULT TRUE
);

CREATE INDEX idx_t1_age ON t1(age);
CREATE UNIQUE INDEX idx_t1_name ON t1(name COLLATE "C");

CREATE TABLE t2(
    order_id INTEGER PRIMARY KEY,
    customer_id INTEGER REFERENCES t1(id),
    product VARCHAR(100) NOT NULL,
    quantity INTEGER DEFAULT 1,
    price DECIMAL(10, 2) NOT NULL,
    order_date TIMESTAMP
);

CREATE INDEX idx_t2_customer_id ON t2(customer_id);
CREATE INDEX idx_t2_order_date ON t2(order_date);

CREATE TABLE t3(
    log_id INTEGER PRIMARY KEY AUTOINCREMENT,
    log_message TEXT,
    log_level VARCHAR(10),
    log_timestamp DATETIME DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO t1 VALUES (1, 'Alice', 30, 50000.00, '2020-01-01', TRUE);
INSERT INTO t1 VALUES (2, 'Bob', 28, 45000.00, '2020-02-01', FALSE);

INSERT INTO t2 VALUES (1, 1, 'Product A', 2, 100.00, '2023-10-01 12:00:00');
INSERT INTO t2 VALUES (2, 1, 'Product B', 5, 75.00, '2023-10-02 14:30:00');

SELECT 
    t1.name,
    t1.age,
    SUM(t2.quantity * t2.price) AS total_sales
FROM 
    t1
JOIN 
    t2 ON t1.id = t2.customer_id
GROUP BY 
    t1.name, t1.age
HAVING 
    SUM(t2.quantity * t2.price) > 500;

SELECT 
    log_message,
    log_level,
    DATE(log_timestamp) AS log_date
FROM 
    t3
WHERE 
    log_level IN ('ERROR', 'WARNING')
ORDER BY 
    log_timestamp DESC
LIMIT 10;

CREATE VIEW v1 AS
SELECT 
    name,
    age,
    salary,
    CASE 
        WHEN salary > 50000 THEN 'High'
        ELSE 'Low'
    END AS salary_category
FROM 
    t1;