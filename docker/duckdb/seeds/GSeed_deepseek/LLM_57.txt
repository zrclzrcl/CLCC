-- Create tables with various data types
CREATE TABLE test_types (
    id INT,
    name TEXT,
    value DECIMAL(10, 2),
    created_at TIMESTAMP,
    status BOOLEAN
);

-- Insert sample data including edge cases
INSERT INTO test_types VALUES 
(0, 'Zero', 0.00, '2023-01-01 00:00:00', FALSE),
(1, 'One', 100.50, '2023-01-01 00:00:01', TRUE),
(999999999, 'Max Int', 999999999.99, '2023-12-31 23:59:59', FALSE),
(NULL, 'Null Name', NULL, NULL, NULL);

-- Create a table for testing NULLs
CREATE TABLE null_test (
    id INT,
    data TEXT
);

INSERT INTO null_test VALUES 
(1, NULL),
(2, 'Some Data'),
(3, NULL);

-- Indexes for performance testing
CREATE INDEX idx_test_types_status ON test_types(status);
CREATE INDEX idx_null_test_id ON null_test(id);

-- Views and CTEs
CREATE VIEW combined_data AS
SELECT t.id, t.name, nt.data 
FROM test_types t 
LEFT JOIN null_test nt ON t.id = nt.id;

WITH recursive_cte AS (
    SELECT 1 as n
    UNION ALL
    SELECT n + 1 FROM recursive_cte WHERE n < 3
)
SELECT * FROM recursive_cte;

-- Complex queries with DuckDB-specific functions
SELECT 
    id, 
    name, 
    created_at,
    duckdb_version() -- DuckDB specific function
FROM test_types
WHERE status = TRUE
ORDER BY created_at DESC;

-- Using window functions and aggregate functions
SELECT 
    id, 
    name, 
    ROW_NUMBER() OVER (ORDER BY created_at) as rn,
    COUNT(*) OVER () as total_rows
FROM test_types
GROUP BY id, name, created_at;