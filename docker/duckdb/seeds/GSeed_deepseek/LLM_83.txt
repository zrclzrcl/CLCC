BEGIN;
CREATE TABLE t1(a INT, b FLOAT, c TEXT);
CREATE TABLE t2 AS SELECT a, b, c FROM t1 WHERE a > 0 UNION ALL SELECT -a, b*2, 'test' || c FROM t1 ORDER BY a DESC LIMIT 5;
INSERT INTO t1 VALUES(1, 1.1, 'one'), (2, 2.2, 'two'), (3, 3.3, 'three');
CREATE TABLE t3(a INT GENERATED ALWAYS AS IDENTITY, b DATE DEFAULT CURRENT_DATE);
INSERT INTO t3(b) VALUES(DEFAULT), (CURRENT_DATE + INTERVAL '7 days');
WITH RECURSIVE cte(n) AS (
    SELECT 1
    UNION ALL
    SELECT n+1 FROM cte WHERE n < 5
)
SELECT * FROM cte;
SELECT 
    a, 
    b, 
    ROW_NUMBER() OVER (ORDER BY a) as rn,
    SUM(b) OVER () as total_sum
FROM t1;
SELECT x.a, y.b FROM t2 x LEFT JOIN t3 y ON x.a = y.a WHERE y.a IS NULL;
VALUES(1),(2),(3) EXCEPT VALUES(2);
COMMIT;