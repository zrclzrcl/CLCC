-- Create table with various data types including NULL values
CREATE TABLE t1 (
  id INTEGER,
  name VARCHAR(50),
  value DECIMAL(10,2),
  created_at DATE,
  is_active BOOLEAN
);

-- Insert sample data including edge cases
INSERT INTO t1 VALUES 
  (1, 'Alice', 100.50, '2023-01-01', TRUE),
  (2, NULL, -999.99, '2024-02-28', FALSE),
  (3, 'Bob', 0.00, '2025-12-31', TRUE);

-- Create another table for join operations
CREATE TABLE t2 (
  id INTEGER,
  category VARCHAR(20),
  points INTEGER
);

-- Insert data into t2
INSERT INTO t2 VALUES 
  (1, 'A', 100),
  (2, 'B', NULL),
  (3, 'C', 500);

-- Use a CTE with window function
WITH cte AS (
  SELECT id, name, ROW_NUMBER() OVER (ORDER BY id) as rn
  FROM t1
)
SELECT * FROM cte WHERE rn % 2 = 0;

-- Test aggregate functions and joins
SELECT 
  t1.id,
  COUNT(t2.points) as total_points,
  SUM(CASE WHEN t2.category = 'A' THEN t2.points ELSE 0 END) as sum_a
FROM t1
LEFT JOIN t2 ON t1.id = t2.id
GROUP BY t1.id;